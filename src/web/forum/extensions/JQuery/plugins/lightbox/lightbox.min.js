if(!window.Vanilla){var Vanilla=new PathFinder();Vanilla.webRoot=Vanilla.getRootPath("script","src","js/global.js")||Vanilla.getRootPath("script","src",/js\/packer\.php.*$/);Vanilla.styleUrl=Vanilla.getRootPath("link","href","vanilla.css")||Vanilla.getRootPath("link","href",/packer\.php.*$/);Vanilla.baseURL=Vanilla.params.httpMethod+Vanilla.params.domain+Vanilla.webRoot}(function(B){var C=Vanilla.webRoot+"extensions/JQuery/plugins/lightbox/";var A;B.fn.lightbox=function(D){A=B.extend({},B.fn.lightbox.defaults,D);B.fn.lightbox.initialize();return this.each(function(){B(this).click(function(){B(this).lightbox.start(this);return false})})};B.fn.lightbox.initialize=function(){B("#overlay").remove();B("#lightbox").remove();A.inprogress=false;var D='<div id="outerImageContainer"><div id="imageContainer"><img id="lightboxImage"><div id="hoverNav"><a href="javascript://" title="'+A.strings.prevLinkTitle+'" id="prevLink"></a><a href="javascript://" id="nextLink" title="'+A.strings.nextLinkTitle+'"></a></div><div id="loading"><a href="javascript://" id="loadingLink"><img src="'+A.fileLoadingImage+'"></a></div></div></div>';var F='<div id="imageDataContainer" class="clearfix"><div id="imageData"><div id="imageDetails"><span id="caption"></span><span id="numberDisplay"></span></div><div id="bottomNav">';if(A.displayHelp){F+='<span id="helpDisplay">'+A.strings.help+"</span>"}F+='<a href="javascript://" id="bottomNavClose" title="'+A.strings.closeTitle+'"><img src="'+A.fileBottomNavCloseImage+'"></a></div></div></div>';var E;if(A.navbarOnTop){E='<div id="overlay"></div><div id="lightbox">'+F+D+"</div>";B("body").append(E);B("#imageDataContainer").addClass("ontop")}else{E='<div id="overlay"></div><div id="lightbox">'+D+F+"</div>";B("body").append(E)}B("#overlay").click(function(){B.fn.lightbox.end()}).hide();B("#lightbox").click(function(){B.fn.lightbox.end()}).hide();B("#loadingLink").click(function(){B.fn.lightbox.end();return false});B("#bottomNavClose").click(function(){B.fn.lightbox.end();return false});B("#outerImageContainer").width(A.widthCurrent).height(A.heightCurrent);B("#imageDataContainer").width(A.widthCurrent)};B.fn.lightbox.getPageSize=function(){var G,D;if(window.innerHeight&&window.scrollMaxY){G=window.innerWidth+window.scrollMaxX;D=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){G=document.body.scrollWidth;D=document.body.scrollHeight}else{G=document.body.offsetWidth;D=document.body.offsetHeight}}var F,H;if(self.innerHeight){if(document.documentElement.clientWidth){F=document.documentElement.clientWidth}else{F=self.innerWidth}H=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){F=document.documentElement.clientWidth;H=document.documentElement.clientHeight}else{if(document.body){F=document.body.clientWidth;H=document.body.clientHeight}}}if(D<H){pageHeight=H}else{pageHeight=D}if(G<F){pageWidth=G}else{pageWidth=F}var E=new Array(pageWidth,pageHeight,F,H);return E};B.fn.lightbox.getPageScroll=function(){var F,D;if(self.pageYOffset){D=self.pageYOffset;F=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){D=document.documentElement.scrollTop;F=document.documentElement.scrollLeft}else{if(document.body){D=document.body.scrollTop;F=document.body.scrollLeft}}}var E=new Array(F,D);return E};B.fn.lightbox.pause=function(F){var E=new Date();var D=null;do{D=new Date()}while(D-E<F)};B.fn.lightbox.start=function(I){B("select, embed, object").hide();var E=B.fn.lightbox.getPageSize();B("#overlay").hide().css({width:"100%",height:E[1]+"px",opacity:A.overlayOpacity}).fadeIn();A.imageArray=[];imageNum=0;var G=document.getElementsByTagName(I.tagName);if(!I.rel||(I.rel=="")){A.imageArray.push(new Array(I.href,A.displayTitle?I.title:""))}else{B("a").each(function(){if(this.href&&(this.rel==I.rel)){A.imageArray.push(new Array(this.href,A.displayTitle?this.title:""))}});for(i=0;i<A.imageArray.length;i++){for(j=A.imageArray.length-1;j>i;j--){if(A.imageArray[i][0]==A.imageArray[j][0]){A.imageArray.splice(j,1)}}}while(A.imageArray[imageNum][0]!=I.href){imageNum++}}var D=B.fn.lightbox.getPageScroll();var H=D[1]+(E[3]/10);var F=D[0];B("#lightbox").css({top:H+"px",left:F+"px"}).show();if(!A.slideNavBar){B("#imageData").hide()}B.fn.lightbox.changeImage(imageNum)};B.fn.lightbox.changeImage=function(D){if(A.inprogress==false){A.inprogress=true;A.activeImage=D;B("#loading").show();B("#lightboxImage").hide();B("#hoverNav").hide();B("#prevLink").hide();B("#nextLink").hide();if(A.slideNavBar){B("#imageDataContainer").hide();B("#imageData").hide();B.fn.doChangeImage()}else{B.fn.doChangeImage()}}};B.fn.doChangeImage=function(){imgPreloader=new Image();imgPreloader.onload=function(){var H=imgPreloader.width;var D=imgPreloader.height;if(A.fitToScreen){var F=B.fn.lightbox.getPageSize();var G;var E=F[2]-2*A.borderSize;var I=F[3]-200;if(imgPreloader.height>I){H=parseInt((I/imgPreloader.height)*imgPreloader.width);D=I}else{if(imgPreloader.width>E){D=parseInt((E/imgPreloader.width)*imgPreloader.height);H=E}}}B("#lightboxImage").attr("src",A.imageArray[A.activeImage][0]).width(H).height(D);B.fn.lightbox.resizeImageContainer(H,D)};imgPreloader.src=A.imageArray[A.activeImage][0]};B.fn.lightbox.end=function(){B.fn.lightbox.disableKeyboardNav();B("#lightbox").hide();B("#overlay").fadeOut();B("select, object, embed").show()};B.fn.lightbox.preloadNeighborImages=function(){if((A.imageArray.length-1)>A.activeImage){preloadNextImage=new Image();preloadNextImage.src=A.imageArray[A.activeImage+1][0]}if(A.activeImage>0){preloadPrevImage=new Image();preloadPrevImage.src=A.imageArray[A.activeImage-1][0]}};B.fn.lightbox.keyboardAction=function(G){if(G==null){var D=event.keyCode;var E=27}else{var D=G.keyCode;var E=G.DOM_VK_ESCAPE}var F=String.fromCharCode(D).toLowerCase();if((F=="x")||(F=="o")||(F=="c")||(D==E)){B.fn.lightbox.end()}else{if((F=="p")||(D==37)){if(A.activeImage!=0){B.fn.lightbox.disableKeyboardNav();B.fn.lightbox.changeImage(A.activeImage-1)}}else{if((F=="n")||(D==39)){if(A.activeImage!=(A.imageArray.length-1)){B.fn.lightbox.disableKeyboardNav();B.fn.lightbox.changeImage(A.activeImage+1)}}}}};B.fn.lightbox.resizeImageContainer=function(G,E){A.widthCurrent=document.getElementById("outerImageContainer").offsetWidth;A.heightCurrent=document.getElementById("outerImageContainer").offsetHeight;var D=(G+(A.borderSize*2));var F=(E+(A.borderSize*2));A.xScale=(D/A.widthCurrent)*100;A.yScale=(F/A.heightCurrent)*100;wDiff=A.widthCurrent-D;hDiff=A.heightCurrent-F;B("#imageDataContainer").animate({width:D},A.resizeSpeed,"linear");B("#outerImageContainer").animate({width:D},A.resizeSpeed,"linear",function(){B("#outerImageContainer").animate({height:F},A.resizeSpeed,"linear",function(){B.fn.lightbox.showImage()})});if((hDiff==0)&&(wDiff==0)){if(jQuery.browser.msie){B.fn.lightbox.pause(250)}else{B.fn.lightbox.pause(100)}}B("#prevLink").height(E);B("#nextLink").height(E)};B.fn.lightbox.showImage=function(){B("#loading").hide();B("#lightboxImage").fadeIn("fast");B.fn.lightbox.updateDetails();B.fn.lightbox.preloadNeighborImages();A.inprogress=false};B.fn.lightbox.updateDetails=function(){if(A.imageArray[A.activeImage][1]){B("#caption").html(A.imageArray[A.activeImage][1]).show()}if(A.imageArray.length>1){var E;E=A.strings.image+(A.activeImage+1)+A.strings.of+A.imageArray.length;if((A.activeImage)>0){E='<a title="'+A.strings.prevLinkTitle+'" href="#" id="prevLinkText">'+A.strings.prevLinkText+"</a>"+E}if((A.activeImage+1)<A.imageArray.length){E+='<a title="'+A.strings.nextLinkTitle+'" href="#" id="nextLinkText">'+A.strings.nextLinkText+"</a>"}B("#numberDisplay").html(E).show()}if(A.slideNavBar){B("#imageData").slideDown(A.navBarSlideSpeed)}else{B("#imageData").show()}var D=B.fn.lightbox.getPageSize();B("#overlay").height(D[1]);B.fn.lightbox.updateNav()};B.fn.lightbox.updateNav=function(){B("#hoverNav").show();if(A.activeImage!=0){B("#prevLink,#prevLinkText").show().click(function(){B.fn.lightbox.changeImage(A.activeImage-1);return false})}if(A.activeImage!=(A.imageArray.length-1)){B("#nextLink,#nextLinkText").show().click(function(){B.fn.lightbox.changeImage(A.activeImage+1);return false})}B.fn.lightbox.enableKeyboardNav()};B.fn.lightbox.enableKeyboardNav=function(){document.onkeydown=B.fn.lightbox.keyboardAction};B.fn.lightbox.disableKeyboardNav=function(){document.onkeydown=""};B.fn.lightbox.defaults={fileLoadingImage:C+"images/loading.gif",fileBottomNavCloseImage:C+"images/closelabel.gif",overlayOpacity:0.8,borderSize:10,imageArray:new Array,activeImage:null,inprogress:false,resizeSpeed:300,widthCurrent:250,heightCurrent:250,xScale:1,yScale:1,displayTitle:true,navbarOnTop:false,slideNavBar:false,navBarSlideSpeed:350,displayHelp:false,strings:{help:" \u2190 / P - previous image\u00a0\u00a0\u00a0\u00a0\u2192 / N - next image\u00a0\u00a0\u00a0\u00a0ESC / X - close image gallery",prevLinkTitle:"previous image",nextLinkTitle:"next image",prevLinkText:"&laquo; Previous",nextLinkText:"Next &raquo;",closeTitle:"close image gallery",image:"Image ",of:" of "},fitToScreen:true};B(document).ready(function(){B(".lightbox").lightbox()})})(jQuery);